<!-- Sales Report -->
<div>
  <section class="content" id="htmle2imagedata">
    <div class="row">
      <div class="col-sm-11">
        <!-- <h5>Invoice Details of {{projectName}}</h5> -->
      </div>
      <div class="col-sm-1" style="justify-content: space-around; display: flex;">
        <span class="glyphicon glyphicon-refresh" data-tooltip title="Sync data"
          style="font-size: 16px !important; cursor: pointer; color: #578fd4;" (click)="refresh()"></span>
        <!-- <span class="glyphicon glyphicon-download-alt" data-tooltip title="Download in excel"
          style="font-size: 16px !important; cursor: pointer; color: #578fd4;"
          (click)="downloadDetailsInExel('Project_Details')"></span> -->
      </div>
    </div>
    <div class="form-filter">
      <div class="col-form-filter mb-3">
        <label>Organization </label>
        <ng-multiselect-dropdown [disabled]="spinner" [placeholder]="'Select'" [data]="orgData"
          [settings]="dropdownSettings" [(ngModel)]="org" id="mddOrg" (onSelectAll)="onSelectDeselectAll($event,'org')"
          (onDeSelectAll)="onSelectDeselectAll($event,'org')">
        </ng-multiselect-dropdown>
      </div>
      <div class="col-form-filter mb-3">
        <label>Region </label>
        <ng-multiselect-dropdown [disabled]="spinner" [placeholder]="'Select'" [data]="regionData"
          [settings]="dropdownSettings" [(ngModel)]="region" id="mddRegion"
          (onSelectAll)="onSelectDeselectAll($event,'region')" (onDeSelectAll)="onSelectDeselectAll($event,'region')">
        </ng-multiselect-dropdown>
      </div>
      <div class="col-form-filter mb-3">
        <label>Practice </label>
        <ng-multiselect-dropdown [disabled]="spinner" [placeholder]="'Select'" [data]="practiceData"
          [settings]="dropdownSettings" [(ngModel)]="practice" id="mddPractice"
          (onSelectAll)="onSelectDeselectAll($event,'practice')"
          (onDeSelectAll)="onSelectDeselectAll($event,'practice')">
        </ng-multiselect-dropdown>
      </div>
      <div class="col-form-filter mb-3">
        <label>Sub-practice </label>
        <ng-multiselect-dropdown [disabled]="spinner" [placeholder]="'Select'" [data]="subPracticeData"
          [settings]="dropdownSettings" [(ngModel)]="subPractices" id="mddSubPractice"
          (onSelectAll)="onSelectDeselectAll($event,'subPractice')"
          (onDeSelectAll)="onSelectDeselectAll($event,'subPractice')">
        </ng-multiselect-dropdown>
      </div>
      <div class="col-form-filter mb-3">
        <label>Client </label>
        <ng-multiselect-dropdown [disabled]="spinner" [placeholder]="'Select'" [data]="clientData"
          [settings]="dropdownSettings" [(ngModel)]="client" id="mddClient"
          (onSelectAll)="onSelectDeselectAll($event,'client')" (onDeSelectAll)="onSelectDeselectAll($event,'client')">
        </ng-multiselect-dropdown>
      </div>
      <div class="col-form-filter mb-3">
        <label>Project </label>
        <ng-multiselect-dropdown [disabled]="spinner" [placeholder]="'Select'" [data]="projectData"
          [settings]="dropdownSettings" [(ngModel)]="project" id="mddProject"
          (onSelectAll)="onSelectDeselectAll($event,'project')" (onDeSelectAll)="onSelectDeselectAll($event,'project')">
        </ng-multiselect-dropdown>
      </div>
    </div>

    <div id="filter">
      <div class="row">
        <div class="col-md-12">
          <div class="card">
            <div class="card-header">
              <div class="row">
                <div class="col-sm-11">
                  <h5>Project Details
                    <!-- <span class="lastRefresh">Last Refresh : {{ refreshDate | date:'medium' }}</span> -->
                  </h5>
                </div>
                <div class="col-sm-1" style="justify-content: space-around; display: flex;">
                  <!-- <span class="glyphicon glyphicon-refresh" data-tooltip title="Sync data"
                style="font-size: 16px !important; cursor: pointer; color: #578fd4;" (click)="refresh()"></span> -->
                  <span class="glyphicon glyphicon-download-alt" data-tooltip title="Download in excel"
                    style="font-size: 16px !important; cursor: pointer;"
                    (click)="downloadDetailsInExel('Project_Details')"></span>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div>
                <ag-grid-angular style="width: auto;" class="ag-theme-balham" 
                  [rowData]="projectInvoices.data"
                  [columnDefs]="columnDefsProjects" 
                  [gridOptions]="gridOptionsProjects"
                  [paginationPageSize]="paginationPageSize" 
                  [getRowHeight]="getRowHeightProjects" 
                  [defaultColDef]="defaultColDef"
                  pagination="true"
                  rowSelection="single" 
                  (selectionChanged)="onProjectSelected($event)" 
                  (gridReady)="onGridReadyProjects($event)">
                </ag-grid-angular>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="filter">
      <div class="row">
        <div class="col-md-12">
          <div class="card">
            <div class="card-header">
              <div class="row">
                <div class="col-sm-11">
                  <h5>Invoice Details of {{projectName}}</h5>
                </div>
                <div *ngIf="projectInvoicesThirdTbl.data && projectInvoicesThirdTbl.data.length" class="col-sm-1"
                  style="justify-content: space-around; display: flex;">
                  <span class="glyphicon glyphicon-download-alt" data-tooltip title="Download in excel"
                    style="font-size: 16px !important; cursor: pointer;"
                    (click)="downloadDetailsInExel('Invoice_Details')"></span>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div>
                <ag-grid-angular style="width: auto;" class="ag-theme-balham" 
                  [rowData]="projectInvoicesThirdTbl.data"
                  [columnDefs]="columnDefsInvoices" 
                  [gridOptions]="gridOptionsInvoices"
                  [paginationPageSize]="paginationPageSize" 
                  [getRowHeight]="getRowHeightInvoices" 
                  [defaultColDef]="defaultColDef"
                  pagination="true"
                  (gridReady)="onGridReadyInvoices($event)">
                </ag-grid-angular>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
    <div *ngIf="spinner" class="overlay">
      <div class="loader"></div>
    </div>
  </section>
</div>